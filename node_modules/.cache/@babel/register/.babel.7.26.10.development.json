{"{\"assumptions\":{},\"sourceRoot\":\"D:\\\\S-GROUP\\\\Backend\\\\BE_2\\\\src\\\\\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"D:\\\\S-GROUP\\\\Backend\\\\BE_2\",\"filename\":\"D:\\\\S-GROUP\\\\Backend\\\\BE_2\\\\src\\\\index.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"D:\\\\S-GROUP\\\\Backend\\\\BE_2\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"transform-duplicate-named-capturing-groups-regex\",\"visitor\":{\"RegExpLiteral\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-regexp-modifiers\",\"visitor\":{\"RegExpLiteral\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-unicode-sets-regex\",\"visitor\":{\"RegExpLiteral\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-class-static-block\",\"visitor\":{\"ClassBody\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-private-property-in-object\",\"visitor\":{\"BinaryExpression\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"loose\":\"#__internal__@babel/preset-env__prefer-false-but-true-is-ok-if-it-prevents-an-error\"},\"externalDependencies\":[]},{\"key\":\"transform-class-properties\",\"visitor\":{\"ExportDefaultDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true,\"ClassExpression\":{\"enter\":[null]},\"ClassDeclaration\":{\"enter\":[null]}},\"options\":{\"loose\":\"#__internal__@babel/preset-env__prefer-false-but-true-is-ok-if-it-prevents-an-error\"},\"externalDependencies\":[]},{\"key\":\"transform-private-methods\",\"visitor\":{\"ExportDefaultDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true,\"ClassExpression\":{\"enter\":[null]},\"ClassDeclaration\":{\"enter\":[null]}},\"options\":{\"loose\":\"#__internal__@babel/preset-env__prefer-false-but-true-is-ok-if-it-prevents-an-error\"},\"externalDependencies\":[]},{\"key\":\"transform-numeric-separator\",\"visitor\":{\"NumericLiteral\":{\"enter\":[null]},\"BigIntLiteral\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-logical-assignment-operators\",\"visitor\":{\"AssignmentExpression\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-nullish-coalescing-operator\",\"visitor\":{\"LogicalExpression\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-optional-chaining\",\"visitor\":{\"_exploded\":true,\"OptionalCallExpression\":{\"enter\":[null]},\"OptionalMemberExpression\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-json-strings\",\"visitor\":{\"_exploded\":true,\"DirectiveLiteral\":{\"enter\":[null]},\"StringLiteral\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-optional-catch-binding\",\"visitor\":{\"CatchClause\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-parameters\",\"visitor\":{\"_exploded\":true,\"_verified\":true,\"FunctionDeclaration\":{\"enter\":[null]},\"FunctionExpression\":{\"enter\":[null]},\"ObjectMethod\":{\"enter\":[null]},\"ArrowFunctionExpression\":{\"enter\":[null]},\"ClassMethod\":{\"enter\":[null]},\"ClassPrivateMethod\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-async-generator-functions\",\"visitor\":{\"Program\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-object-rest-spread\",\"visitor\":{\"VariableDeclarator\":{\"enter\":[null]},\"ExportNamedDeclaration\":{\"enter\":[null]},\"CatchClause\":{\"enter\":[null]},\"AssignmentExpression\":{\"enter\":[null]},\"ArrayPattern\":{\"enter\":[null]},\"ObjectExpression\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true,\"FunctionDeclaration\":{\"enter\":[null]},\"FunctionExpression\":{\"enter\":[null]},\"ObjectMethod\":{\"enter\":[null]},\"ArrowFunctionExpression\":{\"enter\":[null]},\"ClassMethod\":{\"enter\":[null]},\"ClassPrivateMethod\":{\"enter\":[null]},\"ForInStatement\":{\"enter\":[null]},\"ForOfStatement\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-dotall-regex\",\"visitor\":{\"RegExpLiteral\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-unicode-property-regex\",\"visitor\":{\"RegExpLiteral\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-named-capturing-groups-regex\",\"visitor\":{\"RegExpLiteral\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-async-to-generator\",\"visitor\":{\"_exploded\":true,\"_verified\":true,\"FunctionDeclaration\":{\"enter\":[null]},\"FunctionExpression\":{\"enter\":[null]},\"ObjectMethod\":{\"enter\":[null]},\"ArrowFunctionExpression\":{\"enter\":[null]},\"ClassMethod\":{\"enter\":[null]},\"ClassPrivateMethod\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-exponentiation-operator\",\"visitor\":{\"AssignmentExpression\":{\"enter\":[null]},\"BinaryExpression\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-template-literals\",\"visitor\":{\"TaggedTemplateExpression\":{\"enter\":[null]},\"TemplateLiteral\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-literals\",\"visitor\":{\"NumericLiteral\":{\"enter\":[null]},\"StringLiteral\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-function-name\",\"visitor\":{\"FunctionExpression\":{\"exit\":[null]},\"ObjectProperty\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-arrow-functions\",\"visitor\":{\"ArrowFunctionExpression\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-block-scoped-functions\",\"visitor\":{\"BlockStatement\":{\"enter\":[null]},\"SwitchCase\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-classes\",\"visitor\":{\"ExportDefaultDeclaration\":{\"enter\":[null]},\"ClassDeclaration\":{\"enter\":[null]},\"ClassExpression\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-object-super\",\"visitor\":{\"ObjectExpression\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true,\"DoWhileStatement\":{\"exit\":[null]},\"ForInStatement\":{\"exit\":[null]},\"ForStatement\":{\"exit\":[null]},\"WhileStatement\":{\"exit\":[null]},\"ForOfStatement\":{\"exit\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-shorthand-properties\",\"visitor\":{\"ObjectMethod\":{\"enter\":[null]},\"ObjectProperty\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-duplicate-keys\",\"visitor\":{\"ObjectExpression\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-computed-properties\",\"visitor\":{\"ObjectExpression\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-for-of\",\"visitor\":{\"ForOfStatement\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-sticky-regex\",\"visitor\":{\"RegExpLiteral\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-unicode-escapes\",\"visitor\":{\"Identifier\":{\"enter\":[null]},\"TemplateElement\":{\"enter\":[null]},\"_exploded\":true,\"StringLiteral\":{\"enter\":[null]},\"DirectiveLiteral\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-unicode-regex\",\"visitor\":{\"RegExpLiteral\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-spread\",\"visitor\":{\"ArrayExpression\":{\"enter\":[null]},\"CallExpression\":{\"enter\":[null]},\"NewExpression\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-destructuring\",\"visitor\":{\"ExportNamedDeclaration\":{\"enter\":[null]},\"CatchClause\":{\"enter\":[null]},\"AssignmentExpression\":{\"enter\":[null]},\"VariableDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true,\"ForInStatement\":{\"enter\":[null]},\"ForOfStatement\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-block-scoping\",\"visitor\":{\"VariableDeclaration\":{\"enter\":[null,null]},\"BlockStatement\":{\"enter\":[null]},\"SwitchCase\":{\"enter\":[null]},\"ClassDeclaration\":{\"enter\":[null]},\"DoWhileStatement\":{\"enter\":[null]},\"ForInStatement\":{\"enter\":[null]},\"ForStatement\":{\"enter\":[null]},\"WhileStatement\":{\"enter\":[null]},\"ForOfStatement\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-typeof-symbol\",\"visitor\":{\"UnaryExpression\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true,\"BlockStatement\":{\"enter\":[null]},\"CatchClause\":{\"enter\":[null]},\"DoWhileStatement\":{\"enter\":[null]},\"ForInStatement\":{\"enter\":[null]},\"ForStatement\":{\"enter\":[null]},\"FunctionDeclaration\":{\"enter\":[null]},\"FunctionExpression\":{\"enter\":[null]},\"Program\":{\"enter\":[null]},\"ObjectMethod\":{\"enter\":[null]},\"SwitchStatement\":{\"enter\":[null]},\"WhileStatement\":{\"enter\":[null]},\"ArrowFunctionExpression\":{\"enter\":[null]},\"ClassExpression\":{\"enter\":[null]},\"ClassDeclaration\":{\"enter\":[null]},\"ForOfStatement\":{\"enter\":[null]},\"ClassMethod\":{\"enter\":[null]},\"ClassPrivateMethod\":{\"enter\":[null]},\"StaticBlock\":{\"enter\":[null]},\"TSModuleBlock\":{\"enter\":[null]},\"AssignmentPattern\":{\"enter\":[null]},\"ArrayPattern\":{\"enter\":[null]},\"ObjectPattern\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-new-target\",\"visitor\":{\"MetaProperty\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-regenerator\",\"visitor\":{\"ObjectMethod\":{\"enter\":[null],\"exit\":[null]},\"ClassMethod\":{\"enter\":[null],\"exit\":[null]},\"ClassPrivateMethod\":{\"enter\":[null],\"exit\":[null]},\"FunctionDeclaration\":{\"exit\":[null]},\"FunctionExpression\":{\"exit\":[null]},\"ArrowFunctionExpression\":{\"exit\":[null]},\"CallExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-member-expression-literals\",\"visitor\":{\"MemberExpression\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-property-literals\",\"visitor\":{\"ObjectProperty\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-reserved-words\",\"visitor\":{\"_exploded\":true,\"_verified\":true,\"Identifier\":{\"enter\":[null,null]},\"JSXIdentifier\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-export-namespace-from\",\"visitor\":{\"ExportNamedDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"Program\":{\"exit\":[null]},\"_exploded\":true,\"CallExpression\":{\"enter\":[null]},\"ImportExpression\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-dynamic-import\",\"visitor\":{\"Program\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"D:\\\\S-GROUP\\\\Backend\\\\BE_2\\\\node_modules\\\\@babel\\\\preset-env\\\\lib\\\\index.js$47\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"D:\\\\S-GROUP\\\\Backend\\\\BE_2\\\\node_modules\\\\@babel\\\\preset-env\\\\lib\\\\index.js$48\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.26.10:development":{"value":{"code":"\"use strict\";\n\nvar _express = _interopRequireDefault(require(\"express\"));\nvar _fs = _interopRequireDefault(require(\"fs\"));\nfunction _interopRequireDefault(e) { return e && e.__esModule ? e : { \"default\": e }; }\n// Sử dụng fs module để thao tác với file\nvar app = (0, _express[\"default\"])();\nvar port = 3000;\napp.use(_express[\"default\"].json());\n\n// Đọc danh sách người dùng từ file src/users.json\nvar user = [];\n\n// Hàm loadUsers an toàn hơn với xử lý lỗi chi tiết\nvar loadUsers = function loadUsers() {\n  try {\n    var data = _fs[\"default\"].readFileSync('src/users.json', 'utf-8');\n    user = JSON.parse(data);\n  } catch (err) {\n    console.error('Error reading src/users.json:', err);\n    user = []; // Nếu có lỗi, khởi tạo lại danh sách rỗng\n  }\n};\n\n// Lấy dữ liệu người dùng từ file mỗi khi server khởi động\nloadUsers();\n\n// Hàm kiểm tra dữ liệu hợp lệ\nvar validateUser = function validateUser(userData) {\n  return userData && typeof userData.id === 'number' && typeof userData.name === 'string' && userData.name.trim() !== '';\n};\napp.post('/user', function (req, res) {\n  var _req$body = req.body,\n    id = _req$body.id,\n    name = _req$body.name;\n\n  // Kiểm tra validation\n  if (!validateUser(req.body)) {\n    return res.status(400).json({\n      error: 'Invalid data'\n    });\n  }\n\n  // Kiểm tra xem ID đã tồn tại hay chưa\n  if (user.find(function (u) {\n    return u.id === id;\n  })) {\n    return res.status(400).json({\n      error: 'User with this ID already exists'\n    });\n  }\n\n  // Thêm người dùng vào danh sách\n  user.push({\n    id: id,\n    name: name\n  });\n\n  // Cập nhật vào file src/users.json\n  try {\n    _fs[\"default\"].writeFileSync('src/users.json', JSON.stringify(user, null, 2));\n  } catch (err) {\n    console.error('Error writing to src/users.json:', err);\n    return res.status(500).json({\n      error: 'Failed to save data'\n    });\n  }\n  res.status(201).json(user);\n});\napp.get('/user', function (req, res) {\n  res.json(user);\n});\napp.get('/user/:id', function (req, res) {\n  var tmp = user.find(function (user) {\n    return user.id === parseInt(req.params.id);\n  });\n  if (!tmp) {\n    return res.status(404).json({\n      error: 'User not found'\n    });\n  }\n  res.json(tmp);\n});\napp.patch('/user/:id', function (req, res) {\n  var id = req.params.id;\n  var name = req.body.name;\n  var tmp = user.find(function (u) {\n    return u.id === parseInt(id);\n  });\n  if (!tmp) {\n    return res.status(404).json({\n      error: 'User not found'\n    });\n  }\n\n  // Kiểm tra xem có thay đổi tên hay không\n  if (!name || name.trim() === '') {\n    return res.status(400).json({\n      error: 'Invalid name'\n    });\n  }\n\n  // Cập nhật tên\n  tmp.name = name;\n\n  // Cập nhật vào file src/users.json\n  try {\n    _fs[\"default\"].writeFileSync('src/users.json', JSON.stringify(user, null, 2));\n  } catch (err) {\n    console.error('Error writing to src/users.json:', err);\n    return res.status(500).json({\n      error: 'Failed to save data'\n    });\n  }\n  res.json(tmp);\n});\napp[\"delete\"]('/user/:id', function (req, res) {\n  var id = req.params.id;\n  var userIndex = user.findIndex(function (u) {\n    return u.id === parseInt(id);\n  });\n  if (userIndex === -1) {\n    return res.status(404).json({\n      error: 'User not found'\n    });\n  }\n\n  // Xóa người dùng khỏi danh sách\n  user.splice(userIndex, 1);\n\n  // Cập nhật vào file src/users.json\n  try {\n    _fs[\"default\"].writeFileSync('src/users.json', JSON.stringify(user, null, 2));\n  } catch (err) {\n    console.error('Error writing to src/users.json:', err);\n    return res.status(500).json({\n      error: 'Failed to save data'\n    });\n  }\n  res.json(user);\n});\napp.listen(port, function () {\n  console.log(\"Server is running on port \".concat(port));\n});\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfZXhwcmVzcyIsIl9pbnRlcm9wUmVxdWlyZURlZmF1bHQiLCJyZXF1aXJlIiwiX2ZzIiwiZSIsIl9fZXNNb2R1bGUiLCJhcHAiLCJleHByZXNzIiwicG9ydCIsInVzZSIsImpzb24iLCJ1c2VyIiwibG9hZFVzZXJzIiwiZGF0YSIsImZzIiwicmVhZEZpbGVTeW5jIiwiSlNPTiIsInBhcnNlIiwiZXJyIiwiY29uc29sZSIsImVycm9yIiwidmFsaWRhdGVVc2VyIiwidXNlckRhdGEiLCJpZCIsIm5hbWUiLCJ0cmltIiwicG9zdCIsInJlcSIsInJlcyIsIl9yZXEkYm9keSIsImJvZHkiLCJzdGF0dXMiLCJmaW5kIiwidSIsInB1c2giLCJ3cml0ZUZpbGVTeW5jIiwic3RyaW5naWZ5IiwiZ2V0IiwidG1wIiwicGFyc2VJbnQiLCJwYXJhbXMiLCJwYXRjaCIsInVzZXJJbmRleCIsImZpbmRJbmRleCIsInNwbGljZSIsImxpc3RlbiIsImxvZyIsImNvbmNhdCJdLCJzb3VyY2VSb290IjoiRDpcXFMtR1JPVVBcXEJhY2tlbmRcXEJFXzJcXHNyY1xcIiwic291cmNlcyI6WyJpbmRleC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgZXhwcmVzcyBmcm9tICdleHByZXNzJ1xyXG5pbXBvcnQgZnMgZnJvbSAnZnMnIC8vIFPhu60gZOG7pW5nIGZzIG1vZHVsZSDEkeG7gyB0aGFvIHTDoWMgduG7m2kgZmlsZVxyXG5jb25zdCBhcHAgPSBleHByZXNzKClcclxuY29uc3QgcG9ydCA9IDMwMDBcclxuYXBwLnVzZShleHByZXNzLmpzb24oKSlcclxuXHJcbi8vIMSQ4buNYyBkYW5oIHPDoWNoIG5nxrDhu51pIGTDuW5nIHThu6sgZmlsZSBzcmMvdXNlcnMuanNvblxyXG5sZXQgdXNlciA9IFtdXHJcblxyXG4vLyBIw6BtIGxvYWRVc2VycyBhbiB0b8OgbiBoxqFuIHbhu5tpIHjhu60gbMO9IGzhu5dpIGNoaSB0aeG6v3RcclxuY29uc3QgbG9hZFVzZXJzID0gKCkgPT4ge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICBjb25zdCBkYXRhID0gZnMucmVhZEZpbGVTeW5jKCdzcmMvdXNlcnMuanNvbicsICd1dGYtOCcpXHJcbiAgICAgICAgdXNlciA9IEpTT04ucGFyc2UoZGF0YSlcclxuICAgIH0gY2F0Y2ggKGVycikge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIHJlYWRpbmcgc3JjL3VzZXJzLmpzb246JywgZXJyKVxyXG4gICAgICAgIHVzZXIgPSBbXSAvLyBO4bq/dSBjw7MgbOG7l2ksIGto4bufaSB04bqhbyBs4bqhaSBkYW5oIHPDoWNoIHLhu5duZ1xyXG4gICAgfVxyXG59XHJcblxyXG4vLyBM4bqleSBk4buvIGxp4buHdSBuZ8aw4budaSBkw7luZyB04burIGZpbGUgbeG7l2kga2hpIHNlcnZlciBraOG7n2kgxJHhu5luZ1xyXG5sb2FkVXNlcnMoKVxyXG5cclxuLy8gSMOgbSBraeG7g20gdHJhIGThu68gbGnhu4d1IGjhu6NwIGzhu4dcclxuY29uc3QgdmFsaWRhdGVVc2VyID0gKHVzZXJEYXRhKSA9PiB7XHJcbiAgICByZXR1cm4gKFxyXG4gICAgICAgIHVzZXJEYXRhICYmXHJcbiAgICAgICAgdHlwZW9mIHVzZXJEYXRhLmlkID09PSAnbnVtYmVyJyAmJlxyXG4gICAgICAgIHR5cGVvZiB1c2VyRGF0YS5uYW1lID09PSAnc3RyaW5nJyAmJlxyXG4gICAgICAgIHVzZXJEYXRhLm5hbWUudHJpbSgpICE9PSAnJ1xyXG4gICAgKVxyXG59XHJcblxyXG5hcHAucG9zdCgnL3VzZXInLCAocmVxLCByZXMpID0+IHtcclxuICAgIGNvbnN0IHsgaWQsIG5hbWUgfSA9IHJlcS5ib2R5XHJcblxyXG4gICAgLy8gS2nhu4NtIHRyYSB2YWxpZGF0aW9uXHJcbiAgICBpZiAoIXZhbGlkYXRlVXNlcihyZXEuYm9keSkpIHtcclxuICAgICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDApLmpzb24oeyBlcnJvcjogJ0ludmFsaWQgZGF0YScgfSlcclxuICAgIH1cclxuXHJcbiAgICAvLyBLaeG7g20gdHJhIHhlbSBJRCDEkcOjIHThu5NuIHThuqFpIGhheSBjaMawYVxyXG4gICAgaWYgKHVzZXIuZmluZCgodSkgPT4gdS5pZCA9PT0gaWQpKSB7XHJcbiAgICAgICAgcmV0dXJuIHJlc1xyXG4gICAgICAgICAgICAuc3RhdHVzKDQwMClcclxuICAgICAgICAgICAgLmpzb24oeyBlcnJvcjogJ1VzZXIgd2l0aCB0aGlzIElEIGFscmVhZHkgZXhpc3RzJyB9KVxyXG4gICAgfVxyXG5cclxuICAgIC8vIFRow6ptIG5nxrDhu51pIGTDuW5nIHbDoG8gZGFuaCBzw6FjaFxyXG4gICAgdXNlci5wdXNoKHsgaWQsIG5hbWUgfSlcclxuXHJcbiAgICAvLyBD4bqtcCBuaOG6rXQgdsOgbyBmaWxlIHNyYy91c2Vycy5qc29uXHJcbiAgICB0cnkge1xyXG4gICAgICAgIGZzLndyaXRlRmlsZVN5bmMoJ3NyYy91c2Vycy5qc29uJywgSlNPTi5zdHJpbmdpZnkodXNlciwgbnVsbCwgMikpXHJcbiAgICB9IGNhdGNoIChlcnIpIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciB3cml0aW5nIHRvIHNyYy91c2Vycy5qc29uOicsIGVycilcclxuICAgICAgICByZXR1cm4gcmVzLnN0YXR1cyg1MDApLmpzb24oeyBlcnJvcjogJ0ZhaWxlZCB0byBzYXZlIGRhdGEnIH0pXHJcbiAgICB9XHJcblxyXG4gICAgcmVzLnN0YXR1cygyMDEpLmpzb24odXNlcilcclxufSlcclxuXHJcbmFwcC5nZXQoJy91c2VyJywgKHJlcSwgcmVzKSA9PiB7XHJcbiAgICByZXMuanNvbih1c2VyKVxyXG59KVxyXG5cclxuYXBwLmdldCgnL3VzZXIvOmlkJywgKHJlcSwgcmVzKSA9PiB7XHJcbiAgICBjb25zdCB0bXAgPSB1c2VyLmZpbmQoKHVzZXIpID0+IHVzZXIuaWQgPT09IHBhcnNlSW50KHJlcS5wYXJhbXMuaWQpKVxyXG5cclxuICAgIGlmICghdG1wKSB7XHJcbiAgICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDA0KS5qc29uKHsgZXJyb3I6ICdVc2VyIG5vdCBmb3VuZCcgfSlcclxuICAgIH1cclxuXHJcbiAgICByZXMuanNvbih0bXApXHJcbn0pXHJcblxyXG5hcHAucGF0Y2goJy91c2VyLzppZCcsIChyZXEsIHJlcykgPT4ge1xyXG4gICAgY29uc3QgeyBpZCB9ID0gcmVxLnBhcmFtc1xyXG4gICAgY29uc3QgeyBuYW1lIH0gPSByZXEuYm9keVxyXG5cclxuICAgIGNvbnN0IHRtcCA9IHVzZXIuZmluZCgodSkgPT4gdS5pZCA9PT0gcGFyc2VJbnQoaWQpKVxyXG5cclxuICAgIGlmICghdG1wKSB7XHJcbiAgICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDA0KS5qc29uKHsgZXJyb3I6ICdVc2VyIG5vdCBmb3VuZCcgfSlcclxuICAgIH1cclxuXHJcbiAgICAvLyBLaeG7g20gdHJhIHhlbSBjw7MgdGhheSDEkeG7lWkgdMOqbiBoYXkga2jDtG5nXHJcbiAgICBpZiAoIW5hbWUgfHwgbmFtZS50cmltKCkgPT09ICcnKSB7XHJcbiAgICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDAwKS5qc29uKHsgZXJyb3I6ICdJbnZhbGlkIG5hbWUnIH0pXHJcbiAgICB9XHJcblxyXG4gICAgLy8gQ+G6rXAgbmjhuq10IHTDqm5cclxuICAgIHRtcC5uYW1lID0gbmFtZVxyXG5cclxuICAgIC8vIEPhuq1wIG5o4bqtdCB2w6BvIGZpbGUgc3JjL3VzZXJzLmpzb25cclxuICAgIHRyeSB7XHJcbiAgICAgICAgZnMud3JpdGVGaWxlU3luYygnc3JjL3VzZXJzLmpzb24nLCBKU09OLnN0cmluZ2lmeSh1c2VyLCBudWxsLCAyKSlcclxuICAgIH0gY2F0Y2ggKGVycikge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIHdyaXRpbmcgdG8gc3JjL3VzZXJzLmpzb246JywgZXJyKVxyXG4gICAgICAgIHJldHVybiByZXMuc3RhdHVzKDUwMCkuanNvbih7IGVycm9yOiAnRmFpbGVkIHRvIHNhdmUgZGF0YScgfSlcclxuICAgIH1cclxuXHJcbiAgICByZXMuanNvbih0bXApXHJcbn0pXHJcblxyXG5hcHAuZGVsZXRlKCcvdXNlci86aWQnLCAocmVxLCByZXMpID0+IHtcclxuICAgIGNvbnN0IHsgaWQgfSA9IHJlcS5wYXJhbXNcclxuXHJcbiAgICBjb25zdCB1c2VySW5kZXggPSB1c2VyLmZpbmRJbmRleCgodSkgPT4gdS5pZCA9PT0gcGFyc2VJbnQoaWQpKVxyXG5cclxuICAgIGlmICh1c2VySW5kZXggPT09IC0xKSB7XHJcbiAgICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDA0KS5qc29uKHsgZXJyb3I6ICdVc2VyIG5vdCBmb3VuZCcgfSlcclxuICAgIH1cclxuXHJcbiAgICAvLyBYw7NhIG5nxrDhu51pIGTDuW5nIGto4buPaSBkYW5oIHPDoWNoXHJcbiAgICB1c2VyLnNwbGljZSh1c2VySW5kZXgsIDEpXHJcblxyXG4gICAgLy8gQ+G6rXAgbmjhuq10IHbDoG8gZmlsZSBzcmMvdXNlcnMuanNvblxyXG4gICAgdHJ5IHtcclxuICAgICAgICBmcy53cml0ZUZpbGVTeW5jKCdzcmMvdXNlcnMuanNvbicsIEpTT04uc3RyaW5naWZ5KHVzZXIsIG51bGwsIDIpKVxyXG4gICAgfSBjYXRjaCAoZXJyKSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3Igd3JpdGluZyB0byBzcmMvdXNlcnMuanNvbjonLCBlcnIpXHJcbiAgICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNTAwKS5qc29uKHsgZXJyb3I6ICdGYWlsZWQgdG8gc2F2ZSBkYXRhJyB9KVxyXG4gICAgfVxyXG5cclxuICAgIHJlcy5qc29uKHVzZXIpXHJcbn0pXHJcblxyXG5hcHAubGlzdGVuKHBvcnQsICgpID0+IHtcclxuICAgIGNvbnNvbGUubG9nKGBTZXJ2ZXIgaXMgcnVubmluZyBvbiBwb3J0ICR7cG9ydH1gKVxyXG59KVxyXG4iXSwibWFwcGluZ3MiOiI7O0FBQUEsSUFBQUEsUUFBQSxHQUFBQyxzQkFBQSxDQUFBQyxPQUFBO0FBQ0EsSUFBQUMsR0FB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","map":{"version":3,"names":["_express","_interopRequireDefault","require","_fs","e","__esModule","app","express","port","use","json","user","loadUsers","data","fs","readFileSync","JSON","parse","err","console","error","validateUser","userData","id","name","trim","post","req","res","_req$body","body","status","find","u","push","writeFileSync","stringify","get","tmp","parseInt","params","patch","userIndex","findIndex","splice","listen","log","concat"],"sourceRoot":"D:\\S-GROUP\\Backend\\BE_2\\src\\","sources":["index.js"],"sourcesContent":["import express from 'express'\r\nimport fs from 'fs' // Sử dụng fs module để thao tác với file\r\nconst app = express()\r\nconst port = 3000\r\napp.use(express.json())\r\n\r\n// Đọc danh sách người dùng từ file src/users.json\r\nlet user = []\r\n\r\n// Hàm loadUsers an toàn hơn với xử lý lỗi chi tiết\r\nconst loadUsers = () => {\r\n    try {\r\n        const data = fs.readFileSync('src/users.json', 'utf-8')\r\n        user = JSON.parse(data)\r\n    } catch (err) {\r\n        console.error('Error reading src/users.json:', err)\r\n        user = [] // Nếu có lỗi, khởi tạo lại danh sách rỗng\r\n    }\r\n}\r\n\r\n// Lấy dữ liệu người dùng từ file mỗi khi server khởi động\r\nloadUsers()\r\n\r\n// Hàm kiểm tra dữ liệu hợp lệ\r\nconst validateUser = (userData) => {\r\n    return (\r\n        userData &&\r\n        typeof userData.id === 'number' &&\r\n        typeof userData.name === 'string' &&\r\n        userData.name.trim() !== ''\r\n    )\r\n}\r\n\r\napp.post('/user', (req, res) => {\r\n    const { id, name } = req.body\r\n\r\n    // Kiểm tra validation\r\n    if (!validateUser(req.body)) {\r\n        return res.status(400).json({ error: 'Invalid data' })\r\n    }\r\n\r\n    // Kiểm tra xem ID đã tồn tại hay chưa\r\n    if (user.find((u) => u.id === id)) {\r\n        return res\r\n            .status(400)\r\n            .json({ error: 'User with this ID already exists' })\r\n    }\r\n\r\n    // Thêm người dùng vào danh sách\r\n    user.push({ id, name })\r\n\r\n    // Cập nhật vào file src/users.json\r\n    try {\r\n        fs.writeFileSync('src/users.json', JSON.stringify(user, null, 2))\r\n    } catch (err) {\r\n        console.error('Error writing to src/users.json:', err)\r\n        return res.status(500).json({ error: 'Failed to save data' })\r\n    }\r\n\r\n    res.status(201).json(user)\r\n})\r\n\r\napp.get('/user', (req, res) => {\r\n    res.json(user)\r\n})\r\n\r\napp.get('/user/:id', (req, res) => {\r\n    const tmp = user.find((user) => user.id === parseInt(req.params.id))\r\n\r\n    if (!tmp) {\r\n        return res.status(404).json({ error: 'User not found' })\r\n    }\r\n\r\n    res.json(tmp)\r\n})\r\n\r\napp.patch('/user/:id', (req, res) => {\r\n    const { id } = req.params\r\n    const { name } = req.body\r\n\r\n    const tmp = user.find((u) => u.id === parseInt(id))\r\n\r\n    if (!tmp) {\r\n        return res.status(404).json({ error: 'User not found' })\r\n    }\r\n\r\n    // Kiểm tra xem có thay đổi tên hay không\r\n    if (!name || name.trim() === '') {\r\n        return res.status(400).json({ error: 'Invalid name' })\r\n    }\r\n\r\n    // Cập nhật tên\r\n    tmp.name = name\r\n\r\n    // Cập nhật vào file src/users.json\r\n    try {\r\n        fs.writeFileSync('src/users.json', JSON.stringify(user, null, 2))\r\n    } catch (err) {\r\n        console.error('Error writing to src/users.json:', err)\r\n        return res.status(500).json({ error: 'Failed to save data' })\r\n    }\r\n\r\n    res.json(tmp)\r\n})\r\n\r\napp.delete('/user/:id', (req, res) => {\r\n    const { id } = req.params\r\n\r\n    const userIndex = user.findIndex((u) => u.id === parseInt(id))\r\n\r\n    if (userIndex === -1) {\r\n        return res.status(404).json({ error: 'User not found' })\r\n    }\r\n\r\n    // Xóa người dùng khỏi danh sách\r\n    user.splice(userIndex, 1)\r\n\r\n    // Cập nhật vào file src/users.json\r\n    try {\r\n        fs.writeFileSync('src/users.json', JSON.stringify(user, null, 2))\r\n    } catch (err) {\r\n        console.error('Error writing to src/users.json:', err)\r\n        return res.status(500).json({ error: 'Failed to save data' })\r\n    }\r\n\r\n    res.json(user)\r\n})\r\n\r\napp.listen(port, () => {\r\n    console.log(`Server is running on port ${port}`)\r\n})\r\n"],"mappings":"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","ignoreList":[]}},"mtime":1743872659813}}